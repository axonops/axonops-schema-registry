<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1675px" preserveAspectRatio="none" style="width:950px;height:1675px;background:#FFFFFF;" version="1.1" viewBox="0 0 950 1675" width="950px" zoomAndPan="magnify"><title>Authentication Flow</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="249.8955" x="348.5801" y="35.4209">Authentication Flow</text><rect fill="#FFFFFF" height="111.3359" style="stroke:#000000;stroke-width:1;" width="462.7974" x="185.4741" y="290.7344"/><rect fill="#FFFFFF" height="65.0703" style="stroke:none;stroke-width:1;" width="462.7974" x="185.4741" y="337"/><rect fill="#FFFFFF" height="253.8672" style="stroke:#000000;stroke-width:1;" width="514.5591" x="185.4741" y="559.6016"/><rect fill="#FFFFFF" height="186.4688" style="stroke:none;stroke-width:1;" width="514.5591" x="185.4741" y="627"/><rect fill="#FFFFFF" height="90.2031" style="stroke:#000000;stroke-width:1;" width="343.1528" x="15" y="1473.9922"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="343.1528" x="15" y="1520.2578"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="client" id="part1-lifeline"><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="1450.9922" width="8" x="58.2651" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="62" x2="62" y1="130.2031" y2="1581.1953"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="sr" id="part2-lifeline"><g><title>Schema Registry</title><rect fill="#000000" fill-opacity="0.00000" height="1450.9922" width="8" x="267.8135" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="271.4741" x2="271.4741" y1="130.2031" y2="1581.1953"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="auth" id="part3-lifeline"><g><title>Auth Module</title><rect fill="#000000" fill-opacity="0.00000" height="1450.9922" width="8" x="432.9702" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="436.8853" x2="436.8853" y1="130.2031" y2="1581.1953"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="db" id="part4-lifeline"><g><title>User Store</title><rect fill="#000000" fill-opacity="0.00000" height="1450.9922" width="8" x="646.1978" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="649.3623" x2="649.3623" y1="130.2031" y2="1581.1953"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="ldap" id="part5-lifeline"><g><title>LDAP.AD</title><rect fill="#000000" fill-opacity="0.00000" height="1450.9922" width="8" x="743.8701" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="747.0332" x2="747.0332" y1="130.2031" y2="1581.1953"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="oidc" id="part6-lifeline"><g><title>OIDC Provider</title><rect fill="#000000" fill-opacity="0.00000" height="1450.9922" width="8" x="867.8813" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="871.707" x2="871.707" y1="130.2031" y2="1581.1953"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="client" id="part1-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="35" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="42" y="118.9014">Client</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="client" id="part1-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="35" y="1580.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="42" y="1600.1904">Client</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="sr" id="part2-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="132.6787" x="205.4741" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="118.6787" x="212.4741" y="118.9014">Schema Registry</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="sr" id="part2-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="132.6787" x="205.4741" y="1580.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="118.6787" x="212.4741" y="1600.1904">Schema Registry</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="auth" id="part3-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.1699" x="385.8853" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="88.1699" x="392.8853" y="118.9014">Auth Module</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="auth" id="part3-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.1699" x="385.8853" y="1580.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="88.1699" x="392.8853" y="1600.1904">Auth Module</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="db" id="part4-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="73.6709" x="610.3623" y="110.6045">User Store</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="72.4336" x="610.981" y="126.9014">(DB/Vault)</text><path d="M632.1978,61.6094 C632.1978,51.6094 650.1978,51.6094 650.1978,51.6094 C650.1978,51.6094 668.1978,51.6094 668.1978,61.6094 L668.1978,87.6094 C668.1978,97.6094 650.1978,97.6094 650.1978,97.6094 C650.1978,97.6094 632.1978,97.6094 632.1978,87.6094 L632.1978,61.6094" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M632.1978,61.6094 C632.1978,71.6094 650.1978,71.6094 650.1978,71.6094 C650.1978,71.6094 668.1978,71.6094 668.1978,61.6094" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="db" id="part4-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="73.6709" x="610.3623" y="1593.1904">User Store</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="72.4336" x="610.981" y="1609.4873">(DB/Vault)</text><path d="M632.1978,1622.7891 C632.1978,1612.7891 650.1978,1612.7891 650.1978,1612.7891 C650.1978,1612.7891 668.1978,1612.7891 668.1978,1622.7891 L668.1978,1648.7891 C668.1978,1658.7891 650.1978,1658.7891 650.1978,1658.7891 C650.1978,1658.7891 632.1978,1658.7891 632.1978,1648.7891 L632.1978,1622.7891" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M632.1978,1622.7891 C632.1978,1632.7891 650.1978,1632.7891 650.1978,1632.7891 C650.1978,1632.7891 668.1978,1632.7891 668.1978,1622.7891" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="ldap" id="part5-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="75.6738" x="710.0332" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="61.6738" x="717.0332" y="118.9014">LDAP/AD</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="ldap" id="part5-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="75.6738" x="710.0332" y="1580.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="61.6738" x="717.0332" y="1600.1904">LDAP/AD</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="oidc" id="part6-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="112.3486" x="815.707" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="98.3486" x="822.707" y="118.9014">OIDC Provider</text></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="oidc" id="part6-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="112.3486" x="815.707" y="1580.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="98.3486" x="822.707" y="1600.1904">OIDC Provider</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="938.0557" x="5" y="160.7695"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="160.7695" y2="160.7695"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="163.7695" y2="163.7695"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="258.0356" x="345.01" y="150.2031"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="239.5098" x="351.01" y="166.27">API Key Authentication (Cached)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#000000" points="259.8135,200.4688,269.8135,204.4688,259.8135,208.4688,263.8135,204.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="204.4688" y2="204.4688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="185.5483" x="69.2651" y="199.4028">Request + X-API-Key header</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg2"><polygon fill="#000000" points="424.9702,229.6016,434.9702,233.6016,424.9702,237.6016,428.9702,233.6016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="430.9702" y1="233.6016" y2="233.6016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106.4438" x="278.8135" y="228.5356">Validate API Key</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg3"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="262.7344" y2="262.7344"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="262.7344" y2="275.7344"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="275.7344" y2="275.7344"/><polygon fill="#000000" points="447.9702,271.7344,437.9702,275.7344,447.9702,279.7344,443.9702,275.7344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.2329" x="443.9702" y="257.6685">Lookup in memory cache</text></g><path d="M185.4741,290.7344 L249.917,290.7344 L249.917,297.8672 L239.917,307.8672 L185.4741,307.8672 L185.4741,290.7344" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="111.3359" style="stroke:#000000;stroke-width:1;" width="462.7974" x="185.4741" y="290.7344"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="200.4741" y="303.8013">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="69.4268" x="264.917" y="302.9448">[Cache Hit]</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg4"><polygon fill="#000000" points="282.8135,325,272.8135,329,282.8135,333,278.8135,329" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="435.9702" y1="329" y2="329"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="323.9341">User + Role</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="185.4741" x2="648.2715" y1="338" y2="338"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.0034" x="190.4741" y="348.2104">[Cache Miss]</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg5"><polygon fill="#000000" points="282.8135,379.5039,272.8135,383.5039,282.8135,387.5039,278.8135,383.5039" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="435.9702" y1="383.5039" y2="383.5039"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.2256" x="288.8135" y="378.438">401 Unauthorized</text></g><path d="M441,356.8047 L441,396.8047 L632,396.8047 L632,366.8047 L622,356.8047 L441,356.8047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M622,356.8047 L622,366.8047 L632,366.8047 L622,356.8047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.3823" x="447" y="373.8716">Keys loaded on startup</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170.3013" x="447" y="389.0044">and refreshed periodically</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="938.0557" x="5" y="429.6367"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="429.6367" y2="429.6367"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="432.6367" y2="432.6367"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="280.3984" x="333.8286" y="419.0703"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="261.8726" x="339.8286" y="435.1372">Basic Auth (Database - TTL Cached)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg7"><polygon fill="#000000" points="259.8135,469.3359,269.8135,473.3359,259.8135,477.3359,263.8135,473.3359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="473.3359" y2="473.3359"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.5654" x="69.2651" y="468.27">Request + Basic Auth</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg8"><polygon fill="#000000" points="424.9702,498.4688,434.9702,502.4688,424.9702,506.4688,428.9702,502.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="430.9702" y1="502.4688" y2="502.4688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.5684" x="278.8135" y="497.4028">Validate credentials</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg9"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="531.6016" y2="531.6016"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="531.6016" y2="544.6016"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="544.6016" y2="544.6016"/><polygon fill="#000000" points="447.9702,540.6016,437.9702,544.6016,447.9702,548.6016,443.9702,544.6016" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.1826" x="443.9702" y="526.5356">Lookup in credential cache</text></g><path d="M185.4741,559.6016 L249.917,559.6016 L249.917,566.7344 L239.917,576.7344 L185.4741,576.7344 L185.4741,559.6016" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="253.8672" style="stroke:#000000;stroke-width:1;" width="514.5591" x="185.4741" y="559.6016"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="200.4741" y="572.6685">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="147.7803" x="264.917" y="571.812">[Cache Hit (within TTL)]</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg10"><polygon fill="#000000" points="282.8135,604.4336,272.8135,608.4336,282.8135,612.4336,278.8135,608.4336" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="435.9702" y1="608.4336" y2="608.4336"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="603.3677">User + Role</text></g><path d="M441,581.7344 L441,621.7344 L610,621.7344 L610,591.7344 L600,581.7344 L441,581.7344" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M600,581.7344 L600,591.7344 L610,591.7344 L600,581.7344" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.6304" x="447" y="598.8013">Cached for 60 seconds</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.3364" x="447" y="613.9341">(configurable)</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="185.4741" x2="700.0332" y1="628" y2="628"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137.6934" x="190.4741" y="638.2104">[Cache Miss / Expired]</text><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg12"><polygon fill="#000000" points="638.1978,658.9375,648.1978,662.9375,638.1978,666.9375,642.1978,662.9375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="644.1978" y1="662.9375" y2="662.9375"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="443.9702" y="657.8716">Lookup user by username</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg13"><polygon fill="#000000" points="447.9702,688.0703,437.9702,692.0703,447.9702,696.0703,443.9702,692.0703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="441.9702" x2="649.1978" y1="692.0703" y2="692.0703"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167.2163" x="453.9702" y="687.0044">User record (bcrypt hash)</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg14"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="721.2031" y2="721.2031"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="721.2031" y2="734.2031"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="734.2031" y2="734.2031"/><polygon fill="#000000" points="447.9702,730.2031,437.9702,734.2031,447.9702,738.2031,443.9702,734.2031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="104.1968" x="443.9702" y="716.1372">Verify password</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg15"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="763.3359" y2="763.3359"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="763.3359" y2="776.3359"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="776.3359" y2="776.3359"/><polygon fill="#000000" points="447.9702,772.3359,437.9702,776.3359,447.9702,780.3359,443.9702,776.3359" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="199.2275" x="443.9702" y="758.27">Store in cache with timestamp</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg16"><polygon fill="#000000" points="282.8135,801.4688,272.8135,805.4688,282.8135,809.4688,278.8135,805.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="435.9702" y1="805.4688" y2="805.4688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="800.4028">User + Role</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="938.0557" x="5" y="841.0352"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="841.0352" y2="841.0352"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="844.0352" y2="844.0352"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="234.3652" x="356.8452" y="830.4688"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="215.8394" x="362.8452" y="846.5356">Basic Auth (LDAP - No Cache)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg17"><polygon fill="#000000" points="259.8135,880.7344,269.8135,884.7344,259.8135,888.7344,263.8135,884.7344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="884.7344" y2="884.7344"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.5654" x="69.2651" y="879.6685">Request + Basic Auth</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg18"><polygon fill="#000000" points="424.9702,909.8672,434.9702,913.8672,424.9702,917.8672,428.9702,913.8672" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="430.9702" y1="913.8672" y2="913.8672"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.5684" x="278.8135" y="908.8013">Validate credentials</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg19"><polygon fill="#000000" points="735.8701,939,745.8701,943,735.8701,947,739.8701,943" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="741.8701" y1="943" y2="943"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.3936" x="443.9702" y="937.9341">Bind with user credentials</text></g><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg20"><polygon fill="#000000" points="447.9702,968.1328,437.9702,972.1328,447.9702,976.1328,443.9702,972.1328" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="441.9702" x2="746.8701" y1="972.1328" y2="972.1328"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.7334" x="453.9702" y="967.0669">Bind success/failure</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg21"><polygon fill="#000000" points="735.8701,997.2656,745.8701,1001.2656,735.8701,1005.2656,739.8701,1001.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="741.8701" y1="1001.2656" y2="1001.2656"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.3818" x="443.9702" y="996.1997">Search user groups</text></g><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg22"><polygon fill="#000000" points="447.9702,1026.3984,437.9702,1030.3984,447.9702,1034.3984,443.9702,1030.3984" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="441.9702" x2="746.8701" y1="1030.3984" y2="1030.3984"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.5645" x="453.9702" y="1025.3325">Group memberships</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg23"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="1059.5313" y2="1059.5313"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="1059.5313" y2="1072.5313"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="1072.5313" y2="1072.5313"/><polygon fill="#000000" points="447.9702,1068.5313,437.9702,1072.5313,447.9702,1076.5313,443.9702,1072.5313" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.605" x="443.9702" y="1054.4653">Map groups to role</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg24"><polygon fill="#000000" points="282.8135,1097.6641,272.8135,1101.6641,282.8135,1105.6641,278.8135,1101.6641" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="435.9702" y1="1101.6641" y2="1101.6641"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="1096.5981">User + Role</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="938.0557" x="5" y="1130.2305"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="1130.2305" y2="1130.2305"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="1133.2305" y2="1133.2305"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="279.6685" x="334.1936" y="1119.6641"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="261.1426" x="340.1936" y="1135.731">OIDC / Bearer Token (JWKS Cached)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg25"><polygon fill="#000000" points="259.8135,1169.9297,269.8135,1173.9297,259.8135,1177.9297,263.8135,1173.9297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="1173.9297" y2="1173.9297"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.0664" x="69.2651" y="1168.8638">Request + Bearer token</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg26"><polygon fill="#000000" points="424.9702,1199.0625,434.9702,1203.0625,424.9702,1207.0625,428.9702,1203.0625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="430.9702" y1="1203.0625" y2="1203.0625"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94.3452" x="278.8135" y="1197.9966">Validate token</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg27"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="1247.3281" y2="1247.3281"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="1247.3281" y2="1260.3281"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="1260.3281" y2="1260.3281"/><polygon fill="#000000" points="447.9702,1256.3281,437.9702,1260.3281,447.9702,1264.3281,443.9702,1260.3281" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.5327" x="443.9702" y="1227.1294">Verify JWT signature</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="160.5259" x="443.9702" y="1242.2622">(JWKS cached by library)</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg28"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="1289.4609" y2="1289.4609"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="1289.4609" y2="1302.4609"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="1302.4609" y2="1302.4609"/><polygon fill="#000000" points="447.9702,1298.4609,437.9702,1302.4609,447.9702,1306.4609,443.9702,1302.4609" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="195.6665" x="443.9702" y="1284.395">Validate claims (iss, aud, exp)</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg29"><line style="stroke:#000000;stroke-width:1;" x1="436.9702" x2="478.9702" y1="1331.5938" y2="1331.5938"/><line style="stroke:#000000;stroke-width:1;" x1="478.9702" x2="478.9702" y1="1331.5938" y2="1344.5938"/><line style="stroke:#000000;stroke-width:1;" x1="437.9702" x2="478.9702" y1="1344.5938" y2="1344.5938"/><polygon fill="#000000" points="447.9702,1340.5938,437.9702,1344.5938,447.9702,1348.5938,443.9702,1344.5938" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.9976" x="443.9702" y="1326.5278">Extract username &amp; roles</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg30"><polygon fill="#000000" points="282.8135,1369.7266,272.8135,1373.7266,282.8135,1377.7266,278.8135,1373.7266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="435.9702" y1="1373.7266" y2="1373.7266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="1368.6606">User + Role</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="938.0557" x="5" y="1402.293"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="1402.293" y2="1402.293"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="943.0557" y1="1405.293" y2="1405.293"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="166.7944" x="390.6306" y="1391.7266"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.2686" x="396.6306" y="1407.7935">Authorization Check</text><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg31"><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="313.8135" y1="1445.9922" y2="1445.9922"/><line style="stroke:#000000;stroke-width:1;" x1="313.8135" x2="313.8135" y1="1445.9922" y2="1458.9922"/><line style="stroke:#000000;stroke-width:1;" x1="272.8135" x2="313.8135" y1="1458.9922" y2="1458.9922"/><polygon fill="#000000" points="282.8135,1454.9922,272.8135,1458.9922,282.8135,1462.9922,278.8135,1458.9922" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.1567" x="278.8135" y="1440.9263">Check role permissions</text></g><path d="M15,1473.9922 L79.4429,1473.9922 L79.4429,1481.125 L69.4429,1491.125 L15,1491.125 L15,1473.9922" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1;" width="343.1528" x="15" y="1473.9922"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="30" y="1487.0591">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77.9775" x="94.4429" y="1486.2026">[Authorized]</text><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg32"><polygon fill="#000000" points="73.2651,1508.2578,63.2651,1512.2578,73.2651,1516.2578,69.2651,1512.2578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="67.2651" x2="270.8135" y1="1512.2578" y2="1512.2578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="79.2651" y="1507.1919">200 OK</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="15" x2="358.1528" y1="1521.2578" y2="1521.2578"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="73.2349" x="20" y="1531.4683">[Forbidden]</text><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg33"><polygon fill="#000000" points="73.2651,1552.1953,63.2651,1556.1953,73.2651,1560.1953,69.2651,1556.1953" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="67.2651" x2="270.8135" y1="1556.1953" y2="1556.1953"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94.3262" x="79.2651" y="1551.1294">403 Forbidden</text></g><!--SRC=[jLLBJnin4BxlhvXog191bBH5FI2bKXxGyYg81EY1YzUUPAruxQtjRTZ- -ewz2I4lmQMv97Y-RnxVFFZWCymH2iMaJjnCwe9PbaFA-6ngJQd5m2XZOPv9ZqdYfLS8lP98salEl3GQpfIP9mdnw4KMJ7iu62X9W0DW3dZykMuUSGhAu0wdqdbRHPopwvWG1AwDA1L6EwE_4y4yIvb3EBXtQ67aZSKdtHZssm-iLBuPaI9TztGrxDssUyDeKu8LwzQRy-40Rgtv8mNQY35Iy2JfTg5tUmwNM6tMsnWmobyqeTjDwkgWzOtoXnEgw7U9piCX_6eHknNO6JBod92TKA4AmZqm9QaMN8P8ullAVcNCh2n0QiWnDxO27a8cJ7c8mU67z0dGf-OjmqTH3k7EA4nGaKmr-5ewjmDztFa4zpgy6Il_eeWGRIWhAwUPFmc9aMA6qXT0TJjFkfN5asPQWCM9HKSoG85M6a7YA5Kbg4MKhi-Sv54uQ0oNJMl1U7m5xr5lHT-Z6xSeGakOSlkrMu5swGUDkVGPmIYfvXjYRYfJrm0Jseol7N38ZHQE1f6-9t9QMfOgR6ws0Dfm-bn8kr1wcRP8LqcN8MPQnM_DyZem0Lghyc9QbY9Q0OsKswhma36NDTUSBlMYtamgA9XpSoBiWiGTYch5H8Ccu6LEVM1vyTQCxUXss3Rgz4zJL_uV-Xnsc31zIMCOqusglKP6n2lD8jILdADpxGcJghIuwMw4pFA5ht3vYcqttyDpsCWKhSjaiJLwruIlkU0Ds23HVl62SF7ujA5FiSamDZEaytBnU3bwtvRKD1zeU_IhRRkduk9n34vEDVDblA8nBgydcsPGoTGoMpMts2-zeVyPkOC6ZVOH6SKHu7En1JzzzfPn_pBIy34AuzvGfhSuI_N97MJ8Pq6Bkih8gD-2ht22Sig2a2xkU6_zfWKIiHOwdi3dJWTkBklrF3CsbO8cPoVokFFb5IAC-py0]--></g></svg>