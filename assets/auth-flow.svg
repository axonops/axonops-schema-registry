<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1659px" preserveAspectRatio="none" style="width:1049px;height:1659px;background:#FFFFFF;" version="1.1" viewBox="0 0 1049 1659" width="1049px" zoomAndPan="magnify"><title>Authentication Flow</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="249.8955" x="398.5425" y="35.4209">Authentication Flow</text><rect fill="#FFFFFF" height="190.6016" style="stroke:#000000;stroke-width:1;" width="614.4839" x="185.4741" y="290.7344"/><rect fill="#FFFFFF" height="144.3359" style="stroke:none;stroke-width:1;" width="614.4839" x="185.4741" y="337"/><rect fill="#FFFFFF" height="90.2031" style="stroke:#000000;stroke-width:1;" width="343.1528" x="15" y="1458.0547"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="343.1528" x="15" y="1504.3203"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="client" id="part1-lifeline"><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="1435.0547" width="8" x="58.2651" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="62" x2="62" y1="130.2031" y2="1565.2578"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="sr" id="part2-lifeline"><g><title>Schema Registry</title><rect fill="#000000" fill-opacity="0.00000" height="1435.0547" width="8" x="267.8135" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="271.4741" x2="271.4741" y1="130.2031" y2="1565.2578"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="auth" id="part3-lifeline"><g><title>Auth Module</title><rect fill="#000000" fill-opacity="0.00000" height="1435.0547" width="8" x="536.4561" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="540.3711" x2="540.3711" y1="130.2031" y2="1565.2578"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="db" id="part4-lifeline"><g><title>User Store</title><rect fill="#000000" fill-opacity="0.00000" height="1435.0547" width="8" x="746.1226" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="749.2871" x2="749.2871" y1="130.2031" y2="1565.2578"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="ldap" id="part5-lifeline"><g><title>LDAP.AD</title><rect fill="#000000" fill-opacity="0.00000" height="1435.0547" width="8" x="843.7949" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="846.958" x2="846.958" y1="130.2031" y2="1565.2578"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="oidc" id="part6-lifeline"><g><title>OIDC Provider</title><rect fill="#000000" fill-opacity="0.00000" height="1435.0547" width="8" x="967.8062" y="130.2031"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="971.6318" x2="971.6318" y1="130.2031" y2="1565.2578"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="client" id="part1-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="35" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="42" y="118.9014">Client</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="client" id="part1-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="35" y="1564.2578"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="42" y="1584.2529">Client</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="sr" id="part2-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="132.6787" x="205.4741" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="118.6787" x="212.4741" y="118.9014">Schema Registry</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="sr" id="part2-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="132.6787" x="205.4741" y="1564.2578"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="118.6787" x="212.4741" y="1584.2529">Schema Registry</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="auth" id="part3-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.1699" x="489.3711" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="88.1699" x="496.3711" y="118.9014">Auth Module</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="auth" id="part3-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.1699" x="489.3711" y="1564.2578"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="88.1699" x="496.3711" y="1584.2529">Auth Module</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="db" id="part4-head"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="73.6709" x="710.2871" y="110.6045">User Store</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="72.4336" x="710.9058" y="126.9014">(DB/Vault)</text><path d="M732.1226,61.6094 C732.1226,51.6094 750.1226,51.6094 750.1226,51.6094 C750.1226,51.6094 768.1226,51.6094 768.1226,61.6094 L768.1226,87.6094 C768.1226,97.6094 750.1226,97.6094 750.1226,97.6094 C750.1226,97.6094 732.1226,97.6094 732.1226,87.6094 L732.1226,61.6094" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M732.1226,61.6094 C732.1226,71.6094 750.1226,71.6094 750.1226,71.6094 C750.1226,71.6094 768.1226,71.6094 768.1226,61.6094" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="db" id="part4-tail"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="73.6709" x="710.2871" y="1577.2529">User Store</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="72.4336" x="710.9058" y="1593.5498">(DB/Vault)</text><path d="M732.1226,1606.8516 C732.1226,1596.8516 750.1226,1596.8516 750.1226,1596.8516 C750.1226,1596.8516 768.1226,1596.8516 768.1226,1606.8516 L768.1226,1632.8516 C768.1226,1642.8516 750.1226,1642.8516 750.1226,1642.8516 C750.1226,1642.8516 732.1226,1642.8516 732.1226,1632.8516 L732.1226,1606.8516" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M732.1226,1606.8516 C732.1226,1616.8516 750.1226,1616.8516 750.1226,1616.8516 C750.1226,1616.8516 768.1226,1616.8516 768.1226,1606.8516" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="ldap" id="part5-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="75.6738" x="809.958" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="61.6738" x="816.958" y="118.9014">LDAP/AD</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="ldap" id="part5-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="75.6738" x="809.958" y="1564.2578"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="61.6738" x="816.958" y="1584.2529">LDAP/AD</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="oidc" id="part6-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="112.3486" x="915.6318" y="98.9063"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="98.3486" x="922.6318" y="118.9014">OIDC Provider</text></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="oidc" id="part6-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="112.3486" x="915.6318" y="1564.2578"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="98.3486" x="922.6318" y="1584.2529">OIDC Provider</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1037.9805" x="5" y="160.7695"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="160.7695" y2="160.7695"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="163.7695" y2="163.7695"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="188.2305" x="429.875" y="150.2031"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.7046" x="435.875" y="166.27">API Key Authentication</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#000000" points="259.8135,200.4688,269.8135,204.4688,259.8135,208.4688,263.8135,204.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="204.4688" y2="204.4688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="185.5483" x="69.2651" y="199.4028">Request + X-API-Key header</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg2"><polygon fill="#000000" points="528.4561,229.6016,538.4561,233.6016,528.4561,237.6016,532.4561,233.6016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="534.4561" y1="233.6016" y2="233.6016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106.4438" x="278.8135" y="228.5356">Validate API Key</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg3"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="262.7344" y2="262.7344"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="262.7344" y2="275.7344"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="275.7344" y2="275.7344"/><polygon fill="#000000" points="551.4561,271.7344,541.4561,275.7344,551.4561,279.7344,547.4561,275.7344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.6123" x="547.4561" y="257.6685">Check in-memory cache</text></g><path d="M185.4741,290.7344 L249.917,290.7344 L249.917,297.8672 L239.917,307.8672 L185.4741,307.8672 L185.4741,290.7344" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="190.6016" style="stroke:#000000;stroke-width:1;" width="614.4839" x="185.4741" y="290.7344"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="200.4741" y="303.8013">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="69.4268" x="264.917" y="302.9448">[Cache Hit]</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg4"><polygon fill="#000000" points="282.8135,325,272.8135,329,282.8135,333,278.8135,329" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="539.4561" y1="329" y2="329"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="323.9341">User + Role</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="185.4741" x2="799.958" y1="338" y2="338"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.0034" x="190.4741" y="348.2104">[Cache Miss]</text><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg5"><polygon fill="#000000" points="738.1226,368.9375,748.1226,372.9375,738.1226,376.9375,742.1226,372.9375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="744.1226" y1="372.9375" y2="372.9375"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.1216" x="547.4561" y="367.8716">Lookup hashed key</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg6"><polygon fill="#000000" points="551.4561,398.0703,541.4561,402.0703,551.4561,406.0703,547.4561,402.0703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="545.4561" x2="749.1226" y1="402.0703" y2="402.0703"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="95.0879" x="557.4561" y="397.0044">API Key record</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg7"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="431.2031" y2="431.2031"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="431.2031" y2="444.2031"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="444.2031" y2="444.2031"/><polygon fill="#000000" points="551.4561,440.2031,541.4561,444.2031,551.4561,448.2031,547.4561,444.2031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.7114" x="547.4561" y="426.1372">Update cache</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg8"><polygon fill="#000000" points="282.8135,469.3359,272.8135,473.3359,282.8135,477.3359,278.8135,473.3359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="539.4561" y1="473.3359" y2="473.3359"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="468.27">User + Role</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1037.9805" x="5" y="508.9023"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="508.9023" y2="508.9023"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="511.9023" y2="511.9023"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="182.0098" x="432.9854" y="498.3359"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.4839" x="438.9854" y="514.4028">Basic Auth (Database)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg9"><polygon fill="#000000" points="259.8135,548.6016,269.8135,552.6016,259.8135,556.6016,263.8135,552.6016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="552.6016" y2="552.6016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.5654" x="69.2651" y="547.5356">Request + Basic Auth</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg10"><polygon fill="#000000" points="528.4561,577.7344,538.4561,581.7344,528.4561,585.7344,532.4561,581.7344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="534.4561" y1="581.7344" y2="581.7344"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.5684" x="278.8135" y="576.6685">Validate credentials</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg11"><polygon fill="#000000" points="738.1226,606.8672,748.1226,610.8672,738.1226,614.8672,742.1226,610.8672" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="744.1226" y1="610.8672" y2="610.8672"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="547.4561" y="605.8013">Lookup user by username</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg12"><polygon fill="#000000" points="551.4561,636,541.4561,640,551.4561,644,547.4561,640" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="545.4561" x2="749.1226" y1="640" y2="640"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167.2163" x="557.4561" y="634.9341">User record (bcrypt hash)</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg13"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="669.1328" y2="669.1328"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="669.1328" y2="682.1328"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="682.1328" y2="682.1328"/><polygon fill="#000000" points="551.4561,678.1328,541.4561,682.1328,551.4561,686.1328,547.4561,682.1328" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="160.2593" x="547.4561" y="664.0669">Verify password (bcrypt)</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg14"><polygon fill="#000000" points="282.8135,707.2656,272.8135,711.2656,282.8135,715.2656,278.8135,711.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="539.4561" y1="711.2656" y2="711.2656"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="706.1997">User + Role</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1037.9805" x="5" y="739.832"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="739.832" y2="739.832"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="742.832" y2="742.832"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="151.4902" x="448.2451" y="729.2656"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.9644" x="454.2451" y="745.3325">Basic Auth (LDAP)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg15"><polygon fill="#000000" points="259.8135,779.5313,269.8135,783.5313,259.8135,787.5313,263.8135,783.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="783.5313" y2="783.5313"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.5654" x="69.2651" y="778.4653">Request + Basic Auth</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg16"><polygon fill="#000000" points="528.4561,808.6641,538.4561,812.6641,528.4561,816.6641,532.4561,812.6641" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="534.4561" y1="812.6641" y2="812.6641"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.5684" x="278.8135" y="807.5981">Validate credentials</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg17"><polygon fill="#000000" points="835.7949,837.7969,845.7949,841.7969,835.7949,845.7969,839.7949,841.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="841.7949" y1="841.7969" y2="841.7969"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.3936" x="547.4561" y="836.731">Bind with user credentials</text></g><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg18"><polygon fill="#000000" points="551.4561,866.9297,541.4561,870.9297,551.4561,874.9297,547.4561,870.9297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="545.4561" x2="846.7949" y1="870.9297" y2="870.9297"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70.2178" x="557.4561" y="865.8638">Bind result</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg19"><polygon fill="#000000" points="835.7949,896.0625,845.7949,900.0625,835.7949,904.0625,839.7949,900.0625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="841.7949" y1="900.0625" y2="900.0625"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.3818" x="547.4561" y="894.9966">Search user groups</text></g><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg20"><polygon fill="#000000" points="551.4561,925.1953,541.4561,929.1953,551.4561,933.1953,547.4561,929.1953" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="545.4561" x2="846.7949" y1="929.1953" y2="929.1953"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.5645" x="557.4561" y="924.1294">Group memberships</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg21"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="958.3281" y2="958.3281"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="958.3281" y2="971.3281"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="971.3281" y2="971.3281"/><polygon fill="#000000" points="551.4561,967.3281,541.4561,971.3281,551.4561,975.3281,547.4561,971.3281" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.605" x="547.4561" y="953.2622">Map groups to role</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg22"><polygon fill="#000000" points="282.8135,996.4609,272.8135,1000.4609,282.8135,1004.4609,278.8135,1000.4609" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="539.4561" y1="1000.4609" y2="1000.4609"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="995.395">User + Role</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1037.9805" x="5" y="1029.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="1029.0273" y2="1029.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="1032.0273" y2="1032.0273"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="166.7246" x="440.6279" y="1018.4609"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.1987" x="446.6279" y="1034.5278">OIDC / Bearer Token</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg23"><polygon fill="#000000" points="259.8135,1068.7266,269.8135,1072.7266,259.8135,1076.7266,263.8135,1072.7266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="62.2651" x2="265.8135" y1="1072.7266" y2="1072.7266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.0664" x="69.2651" y="1067.6606">Request + Bearer token</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg24"><polygon fill="#000000" points="528.4561,1097.8594,538.4561,1101.8594,528.4561,1105.8594,532.4561,1101.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="534.4561" y1="1101.8594" y2="1101.8594"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94.3452" x="278.8135" y="1096.7935">Validate token</text></g><g class="message" data-entity-1="part3" data-entity-2="part6" id="msg25"><polygon fill="#000000" points="959.8062,1126.9922,969.8062,1130.9922,959.8062,1134.9922,963.8062,1130.9922" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="965.8062" y1="1130.9922" y2="1130.9922"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="134.583" x="547.4561" y="1125.9263">Fetch JWKS (cached)</text></g><g class="message" data-entity-1="part6" data-entity-2="part3" id="msg26"><polygon fill="#000000" points="551.4561,1156.125,541.4561,1160.125,551.4561,1164.125,547.4561,1160.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="545.4561" x2="970.8062" y1="1160.125" y2="1160.125"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="72.8267" x="557.4561" y="1155.0591">Public keys</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg27"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="1189.2578" y2="1189.2578"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="1189.2578" y2="1202.2578"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="1202.2578" y2="1202.2578"/><polygon fill="#000000" points="551.4561,1198.2578,541.4561,1202.2578,551.4561,1206.2578,547.4561,1202.2578" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.5327" x="547.4561" y="1184.1919">Verify JWT signature</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg28"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="1231.3906" y2="1231.3906"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="1231.3906" y2="1244.3906"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="1244.3906" y2="1244.3906"/><polygon fill="#000000" points="551.4561,1240.3906,541.4561,1244.3906,551.4561,1248.3906,547.4561,1244.3906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="195.6665" x="547.4561" y="1226.3247">Validate claims (iss, aud, exp)</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg29"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="1273.5234" y2="1273.5234"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="1273.5234" y2="1286.5234"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="1286.5234" y2="1286.5234"/><polygon fill="#000000" points="551.4561,1282.5234,541.4561,1286.5234,551.4561,1290.5234,547.4561,1286.5234" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.9976" x="547.4561" y="1268.4575">Extract username &amp; roles</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg30"><line style="stroke:#000000;stroke-width:1;" x1="540.4561" x2="582.4561" y1="1315.6563" y2="1315.6563"/><line style="stroke:#000000;stroke-width:1;" x1="582.4561" x2="582.4561" y1="1315.6563" y2="1328.6563"/><line style="stroke:#000000;stroke-width:1;" x1="541.4561" x2="582.4561" y1="1328.6563" y2="1328.6563"/><polygon fill="#000000" points="551.4561,1324.6563,541.4561,1328.6563,551.4561,1332.6563,547.4561,1328.6563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="163.7188" x="547.4561" y="1310.5903">Map roles to registry role</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg31"><polygon fill="#000000" points="282.8135,1353.7891,272.8135,1357.7891,282.8135,1361.7891,278.8135,1357.7891" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="276.8135" x2="539.4561" y1="1357.7891" y2="1357.7891"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.3843" x="288.8135" y="1352.7231">User + Role</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1037.9805" x="5" y="1386.3555"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="1386.3555" y2="1386.3555"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1042.9805" y1="1389.3555" y2="1389.3555"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="166.7944" x="440.593" y="1375.7891"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.2686" x="446.593" y="1391.856">Authorization Check</text><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg32"><line style="stroke:#000000;stroke-width:1;" x1="271.8135" x2="313.8135" y1="1430.0547" y2="1430.0547"/><line style="stroke:#000000;stroke-width:1;" x1="313.8135" x2="313.8135" y1="1430.0547" y2="1443.0547"/><line style="stroke:#000000;stroke-width:1;" x1="272.8135" x2="313.8135" y1="1443.0547" y2="1443.0547"/><polygon fill="#000000" points="282.8135,1439.0547,272.8135,1443.0547,282.8135,1447.0547,278.8135,1443.0547" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="254.6426" x="278.8135" y="1424.9888">Check user role vs required permission</text></g><path d="M15,1458.0547 L79.4429,1458.0547 L79.4429,1465.1875 L69.4429,1475.1875 L15,1475.1875 L15,1458.0547" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1;" width="343.1528" x="15" y="1458.0547"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="30" y="1471.1216">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77.9775" x="94.4429" y="1470.2651">[Authorized]</text><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg33"><polygon fill="#000000" points="73.2651,1492.3203,63.2651,1496.3203,73.2651,1500.3203,69.2651,1496.3203" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="67.2651" x2="270.8135" y1="1496.3203" y2="1496.3203"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.8794" x="79.2651" y="1491.2544">200 OK + Response</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="15" x2="358.1528" y1="1505.3203" y2="1505.3203"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="73.2349" x="20" y="1515.5308">[Forbidden]</text><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg34"><polygon fill="#000000" points="73.2651,1536.2578,63.2651,1540.2578,73.2651,1544.2578,69.2651,1540.2578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="67.2651" x2="270.8135" y1="1540.2578" y2="1540.2578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94.3262" x="79.2651" y="1535.1919">403 Forbidden</text></g><!--SRC=[jLHBJnin4BxxLqmvL8aW0hKz8GKfZzBo4X7XqKClNdlAMl7QnlOIqb_ViNS3IGYqb-QInFFDu_lcyI6MM24upPLXOQQCuvvNK70nk_UsDd9ajVKmBrL4ngAA6c5GavE9Il2eh85ZRUUCaH-zACTDX9sHLWJO0Hv0v9_hvgcWf1oky5w5w1SP5_mw9YM12ojhZTdEwJ-JFFA21uITcu0Ufj5w_6awu-7-BQzrx6QaBDOZdOy7a_t1EDkqv6xTUdao7i74sqSbqMUCLL8mrk_3O782PxZOvDlliuOKz8weR3Wa8WyrXWYxyAD7JhtaL2AdW8piX4h54-wMQqKKS1cPvVSN-wX4CGDbUXLMrYz0S1AASHrXb7x1TnKPqATnMsRFKkp2bTN8K9Cu3VX2XR22FY9T27nkxQnsKF9GeeGPrP0WPEgzbB7axL5OBzTYj8WRbsaqzVsb8YEpc4CUbCXIGcVSjh7xhfOl7c-eA3pAr1Uk0zj6iavb58lyRNY5R9rchhBX29r2-8MBMPVkPbjkqQjV2t0yXFaAU8dRndgJSPh1_y0sZJDXXif8c2jwovHNaHcnGZf3FGRQbiqeK-HUj27IxhlNtj_ICz1q5kX3gLpObEg2y8qlH0i-IV6-I7dzzc58kSbmRMVu_eArm9Y0RmZLs9Q5fMqcwp56udPwTpQ5JXvRsMNPjC9kKXUQUa1B4TuOWTExQmZgtl1OUto5UUuK7TCgG8SMS8-CSW_moRsQggzFqNCHdwSJFcQzjagQ3LdHzcJ-YxHfbgnNlvkhrTmMahOHBNiqRxdXAHuy1ahmK2kQ7t3eAo90hla0BODXSmzI48hIjkaGFXqSmELPoex1MHFQItHiVQ4a3UDMfoy7drSGwL3y0G00]--></g></svg>